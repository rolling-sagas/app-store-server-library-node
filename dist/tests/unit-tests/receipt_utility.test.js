"use strict";
// Copyright (c) 2023 Apple Inc. Licensed under MIT License.
Object.defineProperty(exports, "__esModule", { value: true });
const receipt_utility_1 = require("../../receipt_utility");
const util_1 = require("../util");
describe('Receipt Utility Tets', () => {
    it('should not extract a transaction id from an xcode receipt without a transaction', async () => {
        const receipt = (0, util_1.readFile)('tests/resources/xcode/xcode-app-receipt-empty');
        const receipt_utility = new receipt_utility_1.ReceiptUtility();
        const extracted_transaction_id = receipt_utility.extractTransactionIdFromAppReceipt(receipt);
        expect(extracted_transaction_id).toBeNull();
    });
    it('should extract a transaction id from an xcode receipt with a transaction', async () => {
        const receipt = (0, util_1.readFile)('tests/resources/xcode/xcode-app-receipt-with-transaction');
        const receipt_utility = new receipt_utility_1.ReceiptUtility();
        const extracted_transaction_id = receipt_utility.extractTransactionIdFromAppReceipt(receipt);
        expect(extracted_transaction_id).toBe("0");
    });
    it('should extract a transaction id from an xcode transaction receipt', async () => {
        const receipt = (0, util_1.readFile)('tests/resources/mock_signed_data/legacyTransaction');
        const receipt_utility = new receipt_utility_1.ReceiptUtility();
        const extracted_transaction_id = receipt_utility.extractTransactionIdFromTransactionReceipt(receipt);
        expect(extracted_transaction_id).toBe("33993399");
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVjZWlwdF91dGlsaXR5LnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi90ZXN0cy91bml0LXRlc3RzL3JlY2VpcHRfdXRpbGl0eS50ZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSw0REFBNEQ7O0FBRTVELDJEQUFzRDtBQUN0RCxrQ0FBa0M7QUFHbEMsUUFBUSxDQUFDLHNCQUFzQixFQUFFLEdBQUcsRUFBRTtJQUNsQyxFQUFFLENBQUMsaUZBQWlGLEVBQUUsS0FBSyxJQUFJLEVBQUU7UUFDN0YsTUFBTSxPQUFPLEdBQUcsSUFBQSxlQUFRLEVBQUMsK0NBQStDLENBQUMsQ0FBQTtRQUN6RSxNQUFNLGVBQWUsR0FBRyxJQUFJLGdDQUFjLEVBQUUsQ0FBQTtRQUM1QyxNQUFNLHdCQUF3QixHQUFHLGVBQWUsQ0FBQyxrQ0FBa0MsQ0FBQyxPQUFPLENBQUMsQ0FBQTtRQUM1RixNQUFNLENBQUMsd0JBQXdCLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQTtJQUMvQyxDQUFDLENBQUMsQ0FBQTtJQUNGLEVBQUUsQ0FBQywwRUFBMEUsRUFBRSxLQUFLLElBQUksRUFBRTtRQUN0RixNQUFNLE9BQU8sR0FBRyxJQUFBLGVBQVEsRUFBQywwREFBMEQsQ0FBQyxDQUFBO1FBQ3BGLE1BQU0sZUFBZSxHQUFHLElBQUksZ0NBQWMsRUFBRSxDQUFBO1FBQzVDLE1BQU0sd0JBQXdCLEdBQUcsZUFBZSxDQUFDLGtDQUFrQyxDQUFDLE9BQU8sQ0FBQyxDQUFBO1FBQzVGLE1BQU0sQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQTtJQUM5QyxDQUFDLENBQUMsQ0FBQTtJQUNGLEVBQUUsQ0FBQyxtRUFBbUUsRUFBRSxLQUFLLElBQUksRUFBRTtRQUMvRSxNQUFNLE9BQU8sR0FBRyxJQUFBLGVBQVEsRUFBQyxvREFBb0QsQ0FBQyxDQUFBO1FBQzlFLE1BQU0sZUFBZSxHQUFHLElBQUksZ0NBQWMsRUFBRSxDQUFBO1FBQzVDLE1BQU0sd0JBQXdCLEdBQUcsZUFBZSxDQUFDLDBDQUEwQyxDQUFDLE9BQU8sQ0FBQyxDQUFBO1FBQ3BHLE1BQU0sQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQTtJQUNyRCxDQUFDLENBQUMsQ0FBQTtBQUNOLENBQUMsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IChjKSAyMDIzIEFwcGxlIEluYy4gTGljZW5zZWQgdW5kZXIgTUlUIExpY2Vuc2UuXG5cbmltcG9ydCB7IFJlY2VpcHRVdGlsaXR5IH0gZnJvbSBcIi4uLy4uL3JlY2VpcHRfdXRpbGl0eVwiXG5pbXBvcnQgeyByZWFkRmlsZSB9IGZyb20gXCIuLi91dGlsXCJcblxuXG5kZXNjcmliZSgnUmVjZWlwdCBVdGlsaXR5IFRldHMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBub3QgZXh0cmFjdCBhIHRyYW5zYWN0aW9uIGlkIGZyb20gYW4geGNvZGUgcmVjZWlwdCB3aXRob3V0IGEgdHJhbnNhY3Rpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlY2VpcHQgPSByZWFkRmlsZSgndGVzdHMvcmVzb3VyY2VzL3hjb2RlL3hjb2RlLWFwcC1yZWNlaXB0LWVtcHR5JylcbiAgICAgICAgY29uc3QgcmVjZWlwdF91dGlsaXR5ID0gbmV3IFJlY2VpcHRVdGlsaXR5KClcbiAgICAgICAgY29uc3QgZXh0cmFjdGVkX3RyYW5zYWN0aW9uX2lkID0gcmVjZWlwdF91dGlsaXR5LmV4dHJhY3RUcmFuc2FjdGlvbklkRnJvbUFwcFJlY2VpcHQocmVjZWlwdClcbiAgICAgICAgZXhwZWN0KGV4dHJhY3RlZF90cmFuc2FjdGlvbl9pZCkudG9CZU51bGwoKVxuICAgIH0pXG4gICAgaXQoJ3Nob3VsZCBleHRyYWN0IGEgdHJhbnNhY3Rpb24gaWQgZnJvbSBhbiB4Y29kZSByZWNlaXB0IHdpdGggYSB0cmFuc2FjdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgcmVjZWlwdCA9IHJlYWRGaWxlKCd0ZXN0cy9yZXNvdXJjZXMveGNvZGUveGNvZGUtYXBwLXJlY2VpcHQtd2l0aC10cmFuc2FjdGlvbicpXG4gICAgICAgIGNvbnN0IHJlY2VpcHRfdXRpbGl0eSA9IG5ldyBSZWNlaXB0VXRpbGl0eSgpXG4gICAgICAgIGNvbnN0IGV4dHJhY3RlZF90cmFuc2FjdGlvbl9pZCA9IHJlY2VpcHRfdXRpbGl0eS5leHRyYWN0VHJhbnNhY3Rpb25JZEZyb21BcHBSZWNlaXB0KHJlY2VpcHQpXG4gICAgICAgIGV4cGVjdChleHRyYWN0ZWRfdHJhbnNhY3Rpb25faWQpLnRvQmUoXCIwXCIpXG4gICAgfSlcbiAgICBpdCgnc2hvdWxkIGV4dHJhY3QgYSB0cmFuc2FjdGlvbiBpZCBmcm9tIGFuIHhjb2RlIHRyYW5zYWN0aW9uIHJlY2VpcHQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlY2VpcHQgPSByZWFkRmlsZSgndGVzdHMvcmVzb3VyY2VzL21vY2tfc2lnbmVkX2RhdGEvbGVnYWN5VHJhbnNhY3Rpb24nKVxuICAgICAgICBjb25zdCByZWNlaXB0X3V0aWxpdHkgPSBuZXcgUmVjZWlwdFV0aWxpdHkoKVxuICAgICAgICBjb25zdCBleHRyYWN0ZWRfdHJhbnNhY3Rpb25faWQgPSByZWNlaXB0X3V0aWxpdHkuZXh0cmFjdFRyYW5zYWN0aW9uSWRGcm9tVHJhbnNhY3Rpb25SZWNlaXB0KHJlY2VpcHQpXG4gICAgICAgIGV4cGVjdChleHRyYWN0ZWRfdHJhbnNhY3Rpb25faWQpLnRvQmUoXCIzMzk5MzM5OVwiKVxuICAgIH0pXG59KSJdfQ==